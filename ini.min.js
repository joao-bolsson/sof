
function analisaSolicAlt(c,b,a){$.post("../php/geral.php",{admin:1,form:"analisaSolicAlt",id_solic:c,id_pedido:b,acao:a},function(d){if(d==false){alert(d);window.location.href="index.php"}else{iniSolicitacoes();iniTableSolicAltPed(2)}})}function abreModal(a){$(a).modal()}$(".modal").on("hidden.bs.modal",function(a){$(this).removeClass("fv-modal-stack");$("body").data("fv_open_modals",$("body").data("fv_open_modals")-1)});$(".modal").on("shown.bs.modal",function(a){if(typeof($("body").data("fv_open_modals"))=="undefined"){$("body").data("fv_open_modals",0)}if($(this).hasClass("fv-modal-stack")){return}$(this).addClass("fv-modal-stack");$("body").data("fv_open_modals",$("body").data("fv_open_modals")+1);$(this).css("z-index",1040+(10*$("body").data("fv_open_modals")));$(".modal-backdrop").not(".fv-modal-stack").css("z-index",1039+(10*$("body").data("fv_open_modals")));$(".modal-backdrop").not("fv-modal-stack").addClass("fv-modal-stack")});function avisoSnack(a,b){$(b).snackbar({content:a,show:function(){snackbarText++}})}function iniDataTable(a){$(a).DataTable({destroy:true,searching:true,language:{decimal:"",emptyTable:"Nenhum dado na tabela",info:"_MAX_ resultados encontrados",infoEmpty:"",infoFiltered:"",infoPostFix:"",thousands:",",lengthMenu:"Monstrando _MENU_ entradas",loadingRecords:"Carregando...",processing:"Processando...",search:"Pesquisar:",zeroRecords:"Nenhum resultado encontrado",paginate:{first:"Primeiro",last:"Último",next:"Próximo",previous:"Anterior"},aria:{sortAscending:": activate to sort column ascending",sortDescending:": activate to sort column descending"}},lengthMenu:[[5,10,25,50,-1],[5,10,25,50,"All"]],scrollY:"400px",scrollCollapse:true,paging:false,scrollX:true})}function destroyDataTable(a){$(a).DataTable({destroy:true,searching:true,language:{decimal:"",emptyTable:"Nenhum dado na tabela",info:"",infoEmpty:"",infoFiltered:"",infoPostFix:"",thousands:",",lengthMenu:"Monstrando _MENU_ entradas",loadingRecords:"Carregando...",processing:"Processando...",search:"Pesquisar:",zeroRecords:"Nenhum resultado encontrado",paginate:{first:"Primeiro",last:"Último",next:"Próximo",previous:"Anterior"},aria:{sortAscending:": activate to sort column ascending",sortDescending:": activate to sort column descending"}},lengthMenu:[[5,10,25,50,-1],[5,10,25,50,"All"]],scrollY:"400px",scrollCollapse:true,paging:false,scrollX:true}).destroy()}function addProcesso(a){alert("Adicionar")}function resetSenha(){document.getElementById("loaderResetSenha").style.display="inline-block";var a=document.getElementById("userReset").value;$.post("../php/geral.php",{form:"resetSenha",email:a},function(b){if(b){alert("Sua senha foi resetada e enviada para o seu e-mail.")}else{alert("Ocorreu um erro no servidor. Contate o administrador.")}$("#esqueceuSenha").modal("hide");document.getElementById("formReset").reset();document.getElementById("loaderResetSenha").style.display="none"})}function novaSenha(){document.getElementById("loader").style.display="inline-block";var a=document.getElementById("senhaAtualUser").value;var b=document.getElementById("senhaUser").value;$.post("../php/geral.php",{users:1,form:"novaSenha",novaSenha:b,senhaAtual:a},function(c){if(c){$("#redefinirSenha").modal("hide");document.getElementById("alterSenha").reset();avisoSnack("Sua senha foi redefinida com sucesso!","body")}else{alert("Ocorreu um erro no servidor. Contate o administrador.");location.reload()}document.getElementById("loader").style.display="none"})}function carregaPostsPag(a){document.getElementById("loader");$.post("../php/busca.php",{admin:1,form:"carregaPostsPag",tabela:a},function(b){destroyDataTable("#tableNoticiasEditar");document.getElementById("contNoticiasEditar").innerHTML=b;iniDataTable("#tableNoticiasEditar")})}function iniAdminSolicitacoes(){iniDataTable("#tableItensPedido");iniDataTable("#tableListProcessos");iniSolicitacoes();iniTableSolicAltPed(2);iniTableSolicAdiant(2);iniFreeSaldos();iniRecepcao();avisoSnack("Carregamento concluído !","body")}function iniRecepcao(){$.post("../php/busca.php",{admin:1,form:"tableRecepcao",},function(a){destroyDataTable("#tableRecepcao");document.getElementById("conteudoRecepcao").innerHTML=a;iniDataTable("#tableRecepcao")})}function iniSolicitacoes(){$.post("../php/busca.php",{admin:1,form:"tableItensPedido"},function(a){destroyDataTable("#tableSolicitacoes");document.getElementById("conteudoSolicitacoes").innerHTML=a;iniDataTable("#tableSolicitacoes")})}function formEnvia(){var a=document.getElementById("id_pedido_alt").value;var b=document.getElementById("justificativa_alt_ped").value;$.post("../php/geral.php",{users:1,form:"alt_pedido",id_pedido:a,justificativa:b},function(c){if(c==false){alert(c);window.location.href="index.php"}else{alert("Sua solicitação será análisada. Caso seja aprovada, seu pedido estará na sessão 'Rascunhos'");$("#alt_pedido").modal("hide")}})}function solicAltPed(a){document.getElementById("id_pedido_alt").value=a;abreModal("#alt_pedido");$("#div-lb-high").addClass("control-highlight")}function iniFreeSaldos(){$.post("../php/busca.php",{admin:1,form:"iniFreeSaldos"},function(a){if(a==false){alert(a);window.location.href="index.php"}else{document.getElementById("contFreeSaldos").innerHTML=a}})}function liberaSaldo(b,a,d,c){c=parseFloat(c).toFixed(3);$.post("../php/geral.php",{admin:1,form:"liberaSaldo",id_setor:b,mes:a,ano:d,valor:c},function(e){if(e){alert("O saldo do setor acaba de receber R$ "+c+" referente ao período "+a+"/"+d);iniFreeSaldos()}else{alert("Ocorreu um erro no servidor. Contate o administrador.");window.location.href="sair.php"}})}function iniPagSolicitacoes(){iniDataTable("#tableProcessos");iniDataTable("#tableListProcessos");iniDataTable("#tableMeusPedidos");iniDataTable("#tableRascunhos");iniDataTable("#tableSolicAltPedido");$.post("../php/busca.php",{users:1,form:"iniPagSolicitacoes"},function(a){destroyDataTable("#tableSolicAdi");document.getElementById("contSolicAdi").innerHTML=a;iniDataTable("#tableSolicAdi")})}function iniTableSolicAdiant(a){$.post("../php/busca.php",{admin:1,form:"tableSolicitacoesAdiantamento",status:a},function(b){destroyDataTable("#tableSolicitacoesAdiantamento");document.getElementById("conteudoSolicitacoesAdiantamento").innerHTML=b;iniDataTable("#tableSolicitacoesAdiantamento")})}function iniTableSolicAltPed(a){var b="tableSolicAltPedido";$.post("../php/busca.php",{admin:1,form:"iniTableSolicAltPed",status:a},function(c){destroyDataTable("#"+b);document.getElementById("contSolicAltPedido").innerHTML=c;iniDataTable("#"+b)})}function analisaAdi(c,a){var b;if(a){b=confirm("O setor receberá o valor adiantado e terá esse mesmo valor descontado no próximo mês, estando sujeito à ficar com saldo negativo.\n\nDeseja continuar?")}else{b=confirm("A solicitação de adiantamento será reprovada e o saldo do setor não será alterado.\n\nDeseja continuar?")}if(b){$.post("../php/geral.php",{admin:1,form:"aprovaAdi",id:c,acao:a},function(d){iniTableSolicAdiant(2)})}}function checkItemPedido(c,a,b){qtd_item=document.getElementById("qtd"+c).value;if(qtd_item<=0){document.getElementById("qtd"+c).style.border="0.12em solid red";document.getElementById("qtd"+c).focus()}else{document.getElementById("qtd"+c).style.border="none";document.getElementById("qtd"+c).value="";if(qtd_item>b){avisoSnack("QUANTIDADE INDISPONÍVEL !","body")}else{valor=parseFloat(qtd_item*a).toFixed(3);total_pedido=document.getElementById("total_hidden").value;total_pedido+=valor;saldo_total=parseFloat(document.getElementById("saldo_total").value);if(valor>saldo_total){avisoSnack("SALDO INSUFICIENTE !","body")}else{addItemPedido(c,qtd_item,a)}}}}function addItemPedido(d,e,a){var c=e*a;t=document.getElementById("total_hidden").value;total=parseFloat(t)+parseFloat(c);document.getElementById("total_hidden").value=parseFloat(total).toFixed(3);var b=parseFloat(total).toFixed(3);document.getElementById("total").value="R$ "+b;s=document.getElementById("saldo_total").value;saldo_total=parseFloat(s)-parseFloat(c);document.getElementById("saldo_total").value=parseFloat(saldo_total).toFixed(3);document.getElementById("text_saldo_total").innerHTML="R$ "+parseFloat(saldo_total).toFixed(3);$.post("../php/busca.php",{users:1,form:"addItemPedido",id_item:d,qtd:e},function(f){conteudoPedido=document.getElementById("conteudoPedido").innerHTML;document.getElementById("conteudoPedido").innerHTML=conteudoPedido+f;avisoSnack("Item Inserido ao Pedido !","body")})}function removeTableRow(b,a){t=document.getElementById("total_hidden").value;total=parseFloat(t)-parseFloat(a);document.getElementById("total_hidden").value=parseFloat(total).toFixed(3);document.getElementById("total").value="R$ "+parseFloat(total).toFixed(3);s=document.getElementById("saldo_total").value;saldo_total=parseFloat(s)+parseFloat(a);document.getElementById("saldo_total").value=parseFloat(saldo_total).toFixed(3);document.getElementById("text_saldo_total").innerHTML="R$ "+parseFloat(saldo_total).toFixed(3);var c=document.getElementById("row"+b);if(c.parentNode){c.parentNode.removeChild(c)}avisoSnack("Item Removido do Pedido !","body")}function viewCompl(a){document.getElementById("complementoItem").innerHTML=a;$("#viewCompl").modal()}function pesquisarProcesso(a){if(a==0){a=document.getElementById("searchProcesso").value}else{document.getElementById("searchProcesso").value=a;$("#groupNumProc").addClass("control-highlight");$("#listProcessos").modal("hide")}len=a.length;if(len<20){avisoSnack("Digite um processo válido !","body")}else{$.post("../php/busca.php",{users:1,form:"pesquisarProcesso",busca:a},function(b){avisoSnack("Busca Realizada com Sucesso !","body");destroyDataTable("#tableProcessos");document.getElementById("conteudoProcesso").innerHTML=b;iniDataTable("#tableProcessos")})}}function editaPedido(a){$.post("../php/busca.php",{users:1,form:"populaRascunho",id_pedido:a},function(b){var c=jQuery.parseJSON(b);document.getElementById("total_hidden").value=c.valor;document.getElementById("total").value="R$ "+c.valor;document.getElementById("saldo_total").value=parseFloat(c.saldo-c.valor).toFixed(3);document.getElementById("text_saldo_total").innerHTML="R$ "+parseFloat(c.saldo-c.valor).toFixed(3)});document.getElementById("pedido").value=a;$("#listRascunhos").modal("hide");$.post("../php/busca.php",{users:1,form:"editaPedido",id_pedido:a},function(b){document.getElementById("conteudoPedido").innerHTML=b})}function login(){var b=document.getElementById("user").value;var a=document.getElementById("senha").value;document.getElementById("loader").style.display="inline-block";$.post("../php/login.php",{login:b,senha:a},function(c){if(c=="false"){document.getElementById("formLogin").reset();document.getElementById("aviso").style.display="flex"}else{window.location.href="../"}document.getElementById("loader").style.display="none"})}function aviso(){var a=document.getElementById("aviso");if(a.parentNode){a.parentNode.removeChild(a)}document.getElementById("card").style.marginTop="-3%"}function btnPesquisa(){if(document.getElementById("pesquisa").style.display==""||document.getElementById("pesquisa").style.display=="none"){$("#pesquisa").slideDown(200)}else{$("#pesquisa").slideUp(200)}}function ver_noticia(c,b,a){$.post("../php/busca.php",{form:"ver_noticia",id:c,tabela:b,slide:a},function(d){window.location.href="ver_noticia.php"})}function addInputsArquivo(){qtd=document.getElementById("qtd-arquivos").value;$.post("../php/busca.php",{form:"addInputsArquivo",qtd:qtd},function(a){tabela_arq=document.getElementById("arquivos").innerHTML;document.getElementById("arquivos").innerHTML=tabela_arq+""+a;document.getElementById("qtd-arquivos").value=parseInt(qtd)+1})}function pesquisar(){busca=document.getElementById("search").value;$.post("../php/busca.php",{form:"pesquisar",busca:busca},function(a){document.getElementById("conteudo").innerHTML=a})}function imprimir(a){if(a==0){a=document.getElementById("pedido").value}$.post("../php/busca.php",{users:1,form:"imprimirPedido",id_pedido:a},function(b){window.open("printRel.php")})}function analisarPedido(a,b){document.getElementById("id_setor").value=b;$.post("../php/busca.php",{admin:1,form:"infoPedido",id_pedido:a,id_setor:b},function(c){var d=jQuery.parseJSON(c);document.getElementById("total_hidden").value=d.valor;document.getElementById("total").value="R$ "+d.valor;document.getElementById("saldo_total").value=parseFloat(d.saldo).toFixed(3);document.getElementById("text_saldo_total").innerHTML="R$ "+parseFloat(d.saldo).toFixed(3);document.getElementById("refMes").value=d.ref_mes;document.getElementById("st"+d.prioridade).checked=true;document.getElementById("st"+d.status).checked=true});document.getElementById("id_pedido").value=a;$.post("../php/busca.php",{admin:1,form:"analisaPedido",id_pedido:a},function(c){avisoSnack("Busca Realizada com Sucesso !","body");destroyDataTable("#tableItensPedido");document.getElementById("conteudoPedido").innerHTML=c;iniDataTable("#tableItensPedido")})}function cancelaItem(b){var d=document.getElementById("icon-cancela-item"+b);var a=document.getElementById("item_cancelado"+b).value;if(a=="1"){d.innerHTML="cancel";$("#icon-cancela-item"+b).removeClass("text-green").addClass("text-red");document.getElementById("item_cancelado"+b).value=0;document.getElementById("row_item"+b).style.backgroundColor=""}else{var c=confirm("O item de id = "+b+" será desativado no Banco de Dados ao final da análise do pedido atual, e portanto, os setores não poderão mais solicitá-lo. Deseja prosseguir?");if(c){d.innerHTML="check_circle";$("#icon-cancela-item"+b).removeClass("text-red").addClass("text-green");document.getElementById("item_cancelado"+b).value=1;document.getElementById("row_item"+b).style.backgroundColor="#ffe6e6"}}}function dropTile(b){var a=document.getElementById(b);if(a.parentNode){a.parentNode.removeChild(a)}qtd=document.getElementById("qtd-arquivos").value;document.getElementById("qtd-arquivos").value=parseInt(qtd)-1}function delArquivo(a){del=confirm("Este arquivo será excluído PERMANENTEMENTE do sistema! Estando impossibilitada a sua recuperação.");if(del){$.post("../php/geral.php",{admin:1,form:"delArquivo",caminhoDel:a},function(b){alert(b);window.location.href="index.php"})}}function editaNoticia(c,b,a){document.getElementById("funcao").value="editar";document.getElementById("id_noticia").value=c;document.getElementById("tabela").value=b;document.getElementById("data").value=a;$.post("../php/busca.php",{admin:1,form:"editarNoticia",id:c},function(d){$("#txtnoticia").froalaEditor("destroy");document.getElementById("txtnoticia").value="";$("#txtnoticia").froalaEditor({language:"pt_br",charCounterCount:false,heightMin:100,heightMax:400,imageUploadURL:"upload_image.php",fileUploadURL:"upload_file.php",imageManagerLoadURL:"load_images.php",imageManagerDeleteURL:"delete_image.php",});$("#txtnoticia").froalaEditor("html.insert",d,true);b="op"+document.getElementById("tabela").value;document.getElementById(b).selected=true;$("#listNoticias").modal("hide")})}function recarregaForm(){document.getElementById("funcao").value="novanoticia";document.getElementById("id_noticia").value=0;document.getElementById("tabela").value=0}function excluirNoticia(b){var a=confirm("Essa notícia será desativada do sistema. Deseja continuar?");if(a){$.post("../php/geral.php",{admin:1,form:"excluirNoticia",id:b},function(c){if(!c){window.location.href="../"}else{carregaPostsPag(c)}})}};